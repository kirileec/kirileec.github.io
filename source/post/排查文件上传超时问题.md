title: 排查文件上传超时问题
date: 2021-02-27 23:28:52 +0800
update: ""
author: linx
tags: []
categories: []
topic: ""
cover: ""
draft: false
preview: ""
top: false
type: post
hide: false
toc: false
image: ""
subtitle: ""
config: {}


---



项目为一个自动更新的后台程序，有一个接口为使用form形式提交apk文件到服务端存储起来。然后发现每次上传进度到达91%左右的时候，有时候92%，有时候93%，就停住不动了，F12一看是请求被取消了。而时间停留在了2.1min。

不看还不知道，apk大小高达190M，应该是达到了nginx 200M的配置了。好家伙光libs就占了90M

第一反应，先检查了后端nginx的配置，把跟文件大小有关的配置都变大了10倍，无效

然后又把服务端的配置也改了一下，无效

最后灵机一动，尼玛前端页面设置了请求超时125000，这尼玛刚好2分钟零5秒，四舍五入下可不就是2.1min嘛
